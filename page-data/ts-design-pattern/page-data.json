{"componentChunkName":"component---src-templates-blog-post-js","path":"/ts-design-pattern/","result":{"data":{"site":{"siteMetadata":{"title":"ðŸ¥·'s blog"}},"markdownRemark":{"id":"f596e98a-3203-5f47-882d-5ffe4e597b0e","excerpt":"Creational Patterns Singleton Patterns  The Singleton pattern solves two problems at the same time, violating the Single Responsibility Principle: Ensure that aâ€¦","html":"<h2>Creational Patterns</h2>\n<h3>Singleton Patterns</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/0f1b1d5d1abfc8966400a143abebab6a/0a47e/singleton-comic-1-en.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJUlEQVQozzWRyW8bZQDFP6l/AQfECaFAFyxFbRQhVQTEoRLiUKmtkJC4lDNw4ICKBEIsUtISSE1MmnTi8cx4vCSZxLFju65jO27GHntsz5JZPB7b8XiLPSFdnIRUoDZxmw8FiSe9y+/wfocHClzhi3Kl7FdU1V3UNG9JL3lrtU1vvWH4jHrN32w2QoIoTCJ2dGTid9vrP4/ePO/A8U+C4fDXgZXgVzPI7OXvfvjxnB3D33QQxDBQi6rfqBtwZ2fnv1Y3N2G9YcBWu/lnu93STbPTrFYr239M37WsxmLXVFXR2u3mPxuy0Fc1+ajZajwVRIGOxmLvoDhxBvAC7+52u7BULj9XisV+u73V58TC8W2b9aMUk8HpVGqZzbGBeYq6kc1nYLNVh/v7u5DlGKiVFbi/twv1ShEybLo3NX33EtD1kre324OdbrdfM2rHHXMLigp36PJ6vucFYV+SZZjNsdw8RU0l6QSs1at7ptmp0Zkkw4n5nGl2W7Iq/s2wqaMZxH4dVKoV94nx8eOHfSabfrmhcieD0Okir0Zj8YloLHafzeVCD9bXbWyehZFoJEAtLo1gBPGG1WYbcLrclxPJhCwrUn9xyfcpMIyar9vtwJKuH6Yzacjk6BcbKg+pJerK8or/ymo89jkvCovrKRoVZQ4a9U2olYrP4msJRZI3qqbZeaHpKtR05XCBWvwMpJn0t5Is90/OiKxGeqJSgLyUhwhqH3pA06DA5V5NpdOeUPjeN3kheyRKPGQLmYOZWSS/lkzuPD3461ivajBbYJ6gGHEJjN765e1AMOTjBVFwz7utLMf0wtHgVQhfgtV4/FQgFAIY4RwZn7BagpHgjXgyARmWhmPjt75cSybt29smLPA5xh/2vWu13TkN3N65s0v+ZUs4EvkVI7EPbdO219zzLvB/fhodA6THe3GOos4hs45hnHQyofsraLkhnZJk6ZVw5N7Ao54JxsZvApfHex7YMfzC3MLCRRTH30Mx4i3cSZ7FSXIIxfFBB04MojhhcRDODzAn+f40ggxPTk19/NvtyTMnHEEdlplZ+2nC5RokPZ4Ldgwf+hcUxiqh7N36YwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"singleton-comic-1-en\"\n        title=\"singleton-comic-1-en\"\n        src=\"/blog/static/0f1b1d5d1abfc8966400a143abebab6a/0a47e/singleton-comic-1-en.png\"\n        srcset=\"/blog/static/0f1b1d5d1abfc8966400a143abebab6a/c26ae/singleton-comic-1-en.png 158w,\n/blog/static/0f1b1d5d1abfc8966400a143abebab6a/6bdcf/singleton-comic-1-en.png 315w,\n/blog/static/0f1b1d5d1abfc8966400a143abebab6a/0a47e/singleton-comic-1-en.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>The Singleton pattern solves two problems at the same time, violating the Single Responsibility Principle:</p>\n<ol>\n<li>Ensure that a class has just a single instance.</li>\n<li>Provide a global access point to that instance.</li>\n</ol>\n<blockquote>\n<p>Solution\nAll implementations of the Singleton have these two steps in common:</p>\n</blockquote>\n<ul>\n<li>Make the default constructor private, to prevent other objects from using the <code class=\"language-text\">new</code> operator with the Singleton class.</li>\n<li>Create a static creation method that acts as a constructor. Under the hood, this method calls the private constructor to create an object and saves it in a static field. All following calls to this method return the cached object.</li>\n</ul>\n<p>If your code has access to the Singleton class, then itâ€™s able to call the Singletonâ€™s static method. So whenever that method is called, the same object is always returned.</p>\n<blockquote>\n<p>Why not Singleton Pattern</p>\n</blockquote>\n<ul>\n<li>Violates the Single Responsibility Principle. The pattern solves two problems at the time.</li>\n<li>The Singleton pattern can mask bad design, for instance, when the components of the program know too much about each other.</li>\n<li>The pattern requires special treatment in a multithreaded environment so that multiple threads wonâ€™t create a singleton object several times.</li>\n<li>It may be difficult to unit test the client code of the Singleton because many test frameworks rely on inheritance when producing mock objects. Since the constructor of the singleton class is private and overriding static methods is impossible in most languages, you will need to think of a creative way to mock the singleton. Or just donâ€™t write the tests. Or donâ€™t use the Singleton pattern.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">/**\n * The Singleton class defines the `getInstance` method that lets clients access\n * the unique singleton instance.\n */</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Singleton</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> instance<span class=\"token operator\">:</span> Singleton\n\n  <span class=\"token comment\">/**\n   * The Singleton's constructor should always be private to prevent direct\n   * construction calls with the `new` operator.\n   */</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * The static method that controls the access to the singleton instance.\n   *\n   * This implementation let you subclass the Singleton class while keeping\n   * just one instance of each subclass around.\n   */</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Singleton <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Singleton<span class=\"token punctuation\">.</span>instance<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      Singleton<span class=\"token punctuation\">.</span>instance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> Singleton<span class=\"token punctuation\">.</span>instance\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * Finally, any singleton should define some business logic, which can be\n   * executed on its instance.\n   */</span>\n  <span class=\"token keyword\">public</span> <span class=\"token function\">someBusinessLogic</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * The client code.\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">clientCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> s1 <span class=\"token operator\">=</span> Singleton<span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> s2 <span class=\"token operator\">=</span> Singleton<span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>s1 <span class=\"token operator\">===</span> s2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Singleton works, both variables contain the same instance.\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Singleton failed, variables contain different instances.\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">clientCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Prototype Patterns</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/dae080ccd9f9812ce33b10976715e9fc/6af66/prototype.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.65822784810127%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADzElEQVQ4y31T3WtbBRz9bXMDHzaHDGR1TvfgXvogKlTBOVrRIRTUF0FX8G3Mom4DZ2vaddh1sx/p2mZJ70fud+69uUmTJrm5N7k3uTfJvUmTNG3F1Lp+J1r2UPygMFD82ohkf8B+L4fzcjjncH7Q43DAZ5cuHzIz5gjNsifdCAKNRgOSutYXV5U3URxtA4CDhmlcUBLqB2MTzpcHb914SkmonXo69emEa+LF8cnbz2sp/SVN14ZgJhwCimVeWd9Y+0dNJE6FI7PgQZHjy8vVXSWhsFkr00BwdGhtbbWUs3OhhKY+jMajdGWhEs8X8oZuaDsROWJbtu1eW19dgrSRhpgca6vVtvZicfmUmclAODLbsrp2d0dLJRfNnNFgBSa2sbFetQvWSkJX/o4p0fml75Yyc6XCqmYk9yLx2R/zBVuv1bZM0HQdEAxrrddr9628fXImPAN23m4pV8q7MTWqzlXs+1LIHyvPl37X0kk9VzD3VF3WLdu6p6WSpdycuaXq8oKZNe/W6zUT3OgdSJtpl5kx/kJwrPVqX8+JlR9WjqXN9O6UxzUiBoVfnZPj/UbG+APB0SlOZDdQAh3VUto9kqECnMCW3KibN0zDrtW3LSBZ6rhl5x5oKe0nkiWFmUjwF5zE2/MF+2cloRBWIcdRHH21ulytZHKZmKopSEJTB4ulopa1shkjm54ORUJDxVLRv7W9aQHtowb8M2JDSSp/ol5se8rjupQv53bKi8WHNMs43eh0Z2+/o6tW3/7eLtixK1992TEyPna+ulxNleZL+Rvf3uz8+lpfZ7FcDG5ubpTBS3vnBYn/beLO1MKwc7S9ORle4qxoPLLjD4rXeckX9GDuwcJcQYrGI2OswMicyHqMjMnHVdnJikyA4khCSSj8wmKlB5J60oeRuNcxcO2dYecoiGLwSVmNpZWkEgaAAxiJnac5uqf7i8+PDA73H2J4+mn/jHCkt99xuP3ds09wInOUE+jD45PjR5tmgBN8TpTALjcJThEQkSOtGOF93x+QPnqjo+NYPCGv5Oxs40L3xWd7+nphVg6Cz8+BY6APzp4706wMKI6AsQnno4cAKSS6xKCABsL+04LEQyDkP81LPkkI8DznZ5/Z3Fw/EZWjF6fcd153Tt4GD+bZj1MYkAwFCD4NGInuay6FZMh9NEcDdH3SdQCnsBcIhvgY9WLvIV70Q17i3mYF5i1e8j1HMEQ7Tnlveimim+VZYHzMfnjcuZDJR+gTuU7e77vuRjyvBcISBGcl+ObW4EFOYM9xItvSjPPfg3+h7cyrj9X7H7NGUQOCbUChAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"prototype\"\n        title=\"prototype\"\n        src=\"/blog/static/dae080ccd9f9812ce33b10976715e9fc/f058b/prototype.png\"\n        srcset=\"/blog/static/dae080ccd9f9812ce33b10976715e9fc/c26ae/prototype.png 158w,\n/blog/static/dae080ccd9f9812ce33b10976715e9fc/6bdcf/prototype.png 315w,\n/blog/static/dae080ccd9f9812ce33b10976715e9fc/f058b/prototype.png 630w,\n/blog/static/dae080ccd9f9812ce33b10976715e9fc/6af66/prototype.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"ðŸ’Ž TS Design Pattern","date":"July 06, 2020","description":"ES5 design pattern."}},"previous":{"fields":{"slug":"/system-design-101/"},"frontmatter":{"title":"System design interview"}},"next":null},"pageContext":{"id":"f596e98a-3203-5f47-882d-5ffe4e597b0e","previousPostId":"50caf298-0738-52ab-9799-10a6a28cd5c7","nextPostId":null}},"staticQueryHashes":["2841359383","3257411868"]}